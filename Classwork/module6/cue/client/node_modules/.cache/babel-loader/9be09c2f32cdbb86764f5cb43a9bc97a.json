{"ast":null,"code":"var _jsxFileName = \"/Users/quinntoncarter/Documents/VSchool/Classwork/module6/cue/client/src/components/context/spotifyProvider.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport { UserContext } from './userProvider.js'; // ** might be broken, vscode is acting weird: also check Auth.js for problems\n\nimport { accessToken, getCurrentUserProfile } from '../spotify.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const SpotifyContext = /*#__PURE__*/React.createContext();\nexport default function SpotifyProvider(props) {\n  _s();\n\n  // ** BETA get token from userState\n  // const [ spotifyToken, setSpotifyToken ] = useState(null);\n  const [spotifyProfile, setSpotifyProfile] = useState(null); // ** refactor this to work from this page and save some info into local state for use like userProvider\n  // ** may need to edit spotify.js to save user info in localstorage.. or useEffect below to do it\n\n  const initState = {\n    spotifyUser: JSON.parse(localStorage.getItem('spotifyUser')) || {},\n    spotifyToken: localStorage.getItem('spotify_access_token') || '',\n    errMsg: ''\n  };\n  const [spotifyUserState, setSpotifyUserState] = useState(initState);\n  const {\n    logout\n  } = useContext(UserContext);\n  useEffect(() => {\n    if (accessToken) {\n      // ** BETA get token from userState\n      // setSpotifyToken(accessToken);\n      localStorage.setItem('spotify_access_token', accessToken);\n\n      const fetchData = async () => {\n        try {\n          const {\n            data\n          } = await getCurrentUserProfile();\n          setSpotifyProfile(data); // where user information should be sent to back for use in model\n          // will need to reapply email each time on login\n          // just post to signup model route for new users\n\n          localStorage.setItem('spotifyUser', JSON.stringify(data));\n        } catch (err) {\n          // \n          console.error(err);\n        }\n      };\n\n      fetchData();\n    } else if (!accessToken & spotifyUserState.spotifyToken) {\n      return;\n    } else if (!accessToken & !spotifyUserState.spotifyToken) {\n      logout();\n    }\n  }, [spotifyToken, setSpotifyProfile, logout]);\n  return /*#__PURE__*/_jsxDEV(SpotifyContext.Provider, {\n    value: {\n      spotifyProfile,\n      spotifyToken,\n      setSpotifyToken\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 9\n  }, this);\n}\n\n_s(SpotifyProvider, \"wvFpYVv523yaxt9sP7B02Kbb24s=\");\n\n_c = SpotifyProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"SpotifyProvider\");","map":{"version":3,"sources":["/Users/quinntoncarter/Documents/VSchool/Classwork/module6/cue/client/src/components/context/spotifyProvider.js"],"names":["React","useEffect","useState","useContext","UserContext","accessToken","getCurrentUserProfile","SpotifyContext","createContext","SpotifyProvider","props","spotifyProfile","setSpotifyProfile","initState","spotifyUser","JSON","parse","localStorage","getItem","spotifyToken","errMsg","spotifyUserState","setSpotifyUserState","logout","setItem","fetchData","data","stringify","err","console","error","setSpotifyToken","children"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,UAArC,QAAuD,OAAvD;AACA,SAASC,WAAT,QAA4B,mBAA5B,C,CACA;;AACA,SAASC,WAAT,EAAsBC,qBAAtB,QAAmD,eAAnD;;AAEA,OAAO,MAAMC,cAAc,gBAAGP,KAAK,CAACQ,aAAN,EAAvB;AAEP,eAAe,SAASC,eAAT,CAAyBC,KAAzB,EAA+B;AAAA;;AAC9C;AACI;AACA,QAAM,CAAEC,cAAF,EAAkBC,iBAAlB,IAAwCV,QAAQ,CAAC,IAAD,CAAtD,CAH0C,CAK9C;AACA;;AACI,QAAMW,SAAS,GAAG;AACdC,IAAAA,WAAW,EAAEC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAX,KAAmD,EADlD;AAEdC,IAAAA,YAAY,EAAEF,YAAY,CAACC,OAAb,CAAqB,sBAArB,KAAgD,EAFhD;AAGdE,IAAAA,MAAM,EAAE;AAHM,GAAlB;AAMA,QAAM,CAAEC,gBAAF,EAAoBC,mBAApB,IAA4CpB,QAAQ,CAACW,SAAD,CAA1D;AAEA,QAAM;AACFU,IAAAA;AADE,MAEFpB,UAAU,CAACC,WAAD,CAFd;AAKAH,EAAAA,SAAS,CAAC,MAAK;AACX,QAAGI,WAAH,EAAe;AACf;AACI;AACAY,MAAAA,YAAY,CAACO,OAAb,CAAqB,sBAArB,EAA6CnB,WAA7C;;AAEA,YAAMoB,SAAS,GAAG,YAAY;AAC9B,YAAI;AACA,gBAAM;AAAEC,YAAAA;AAAF,cAAW,MAAMpB,qBAAqB,EAA5C;AACAM,UAAAA,iBAAiB,CAACc,IAAD,CAAjB,CAFA,CAGA;AACA;AACA;;AACAT,UAAAA,YAAY,CAACO,OAAb,CAAqB,aAArB,EAAoCT,IAAI,CAACY,SAAL,CAAeD,IAAf,CAApC;AAEH,SARD,CAQE,OAAME,GAAN,EAAW;AACT;AACAC,UAAAA,OAAO,CAACC,KAAR,CAAcF,GAAd;AACH;AAAC,OAZF;;AAaAH,MAAAA,SAAS;AACZ,KAnBD,MAmBO,IAAI,CAACpB,WAAD,GAAegB,gBAAgB,CAACF,YAApC,EAAiD;AACpD;AACH,KAFM,MAEA,IAAI,CAACd,WAAD,GAAe,CAACgB,gBAAgB,CAACF,YAArC,EAAkD;AACrDI,MAAAA,MAAM;AACT;AACJ,GAzBQ,EAyBN,CAACJ,YAAD,EAAeP,iBAAf,EAAkCW,MAAlC,CAzBM,CAAT;AA2BA,sBACI,QAAC,cAAD,CAAgB,QAAhB;AACI,IAAA,KAAK,EAAE;AACHZ,MAAAA,cADG;AAEHQ,MAAAA,YAFG;AAGHY,MAAAA;AAHG,KADX;AAAA,cAMKrB,KAAK,CAACsB;AANX;AAAA;AAAA;AAAA;AAAA,UADJ;AAUH;;GAzDuBvB,e;;KAAAA,e","sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport { UserContext } from './userProvider.js';\n// ** might be broken, vscode is acting weird: also check Auth.js for problems\nimport { accessToken, getCurrentUserProfile } from '../spotify.js';\n\nexport const SpotifyContext = React.createContext();\n\nexport default function SpotifyProvider(props){\n// ** BETA get token from userState\n    // const [ spotifyToken, setSpotifyToken ] = useState(null);\n    const [ spotifyProfile, setSpotifyProfile ] = useState(null);\n\n// ** refactor this to work from this page and save some info into local state for use like userProvider\n// ** may need to edit spotify.js to save user info in localstorage.. or useEffect below to do it\n    const initState = {\n        spotifyUser: JSON.parse(localStorage.getItem('spotifyUser')) || {},\n        spotifyToken: localStorage.getItem('spotify_access_token') || '',\n        errMsg: ''\n    };\n\n    const [ spotifyUserState, setSpotifyUserState ] = useState(initState)\n\n    const {\n        logout\n    } = useContext(UserContext)\n\n\n    useEffect(()=> {\n        if(accessToken){\n        // ** BETA get token from userState\n            // setSpotifyToken(accessToken);\n            localStorage.setItem('spotify_access_token', accessToken)\n    \n            const fetchData = async () => {\n            try {\n                const { data } = await getCurrentUserProfile();\n                setSpotifyProfile(data);\n                // where user information should be sent to back for use in model\n                // will need to reapply email each time on login\n                // just post to signup model route for new users\n                localStorage.setItem('spotifyUser', JSON.stringify(data))\n\n            } catch(err) {\n                // \n                console.error(err);\n            }}\n            fetchData();\n        } else if (!accessToken & spotifyUserState.spotifyToken){\n            return;\n        } else if (!accessToken & !spotifyUserState.spotifyToken){\n            logout();\n        }\n    }, [spotifyToken, setSpotifyProfile, logout])\n    \n    return(\n        <SpotifyContext.Provider\n            value={{\n                spotifyProfile,\n                spotifyToken,\n                setSpotifyToken\n            }}>\n            {props.children}\n        </SpotifyContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}